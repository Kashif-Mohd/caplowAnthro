using MySql.Data.MySqlClient;
using System;
using System.Collections.Generic;
using System.Configuration;
using System.Data;
using System.Globalization;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Drawing;
using System.Web.UI.DataVisualization.Charting;


namespace caplowanthro
{
    public partial class dashboard : System.Web.UI.Page
    {

        string constr = ConfigurationManager.ConnectionStrings["LocalMySql"].ConnectionString;
        protected void Page_Load(object sender, EventArgs e)
        {
            if (!IsPostBack)
            {
                txtCalndrDate.Text = DateTime.Now.ToString("dd-MM-yyyy");
                txtCalndrDate1.Text = DateTime.Now.ToString("dd-MM-yyyy");
                lbeUname.Text = Convert.ToString(Session["CPusername"]);
                Session["WebForm"] = "Dashboard";
                LoadChartUserWise();
                LoadChartBirthCapturing();
                LoadChartLiveBirth();
                ShowEnrollment();
                ShowFollowups();
                Mortality();
            }
        }




        protected void btnSearch_Click(object sender, EventArgs e)
        {
            LoadChartUserWise();
            ShowEnrollment();
            ShowFollowups();
            LoadChartBirthCapturing();
            LoadChartLiveBirth();
            Mortality();
        }




        private void LoadChartUserWise()
        {
            Chart1.ChartAreas["ChartArea1"].AxisX.MajorGrid.Enabled = false;
            Chart1.DataBindCrossTable(GetDataItem().DefaultView, "sra_name", "Enrollment", "total", "Label=total");
            Chart1.DataBind();
        }





        private DataTable GetDataItem()
        {
            MySqlConnection con = new MySqlConnection(constr);
            con.Open();
            MySqlCommand cmd = new MySqlCommand("select a.sra_name,'Enrollment', (select count(*) as total from form_1 as b left join team as z on b.team_id=z.team_id where str_to_date(b.form1_q01, '%d-%m-%Y') BETWEEN str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y')  and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y') and a.sra_name=z.sra_name  group by z.sra_name) as total from  team as a where a.status=1 union all select a.sra_name,'Complete', (select count(*) as total from form_1 as b left join team as z on b.team_id=z.team_id where str_to_date(b.form1_q01, '%d-%m-%Y') BETWEEN str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y')  and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y') and a.sra_name=z.sra_name and form1_q15='1'  group by z.sra_name) as total from  team as a where a.status=1 union all select a.sra_name,'Incomplete', (select count(*) as total from form_1 as b left join team as z on b.team_id=z.team_id where str_to_date(b.form1_q01, '%d-%m-%Y') BETWEEN str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y')  and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y') and a.sra_name=z.sra_name and form1_q15!='1'  group by z.sra_name) as total from  team as a where a.status=1 union all select a.sra_name,'Followups', (select count(*) as total from view_form2 as b where str_to_date(b.q01, '%d-%m-%Y') BETWEEN str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y')  and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y') and a.sra_name=b.sra_name  group by b.sra_name) as total from  team as a where a.status=1 union all select a.sra_name,'Complete F/ups', (select count(*) as total from view_form2 as b where str_to_date(b.q01, '%d-%m-%Y') BETWEEN str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y')  and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y') and a.sra_name=b.sra_name and q16='1' group by b.sra_name) as total from  team as a where a.status=1 union all select a.sra_name,'Incomplete F/ups', (select count(*) as total from view_form2 as b where str_to_date(b.q01, '%d-%m-%Y') BETWEEN str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y')  and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y') and a.sra_name=b.sra_name  and q16!='1' group by b.sra_name) as total from  team as a where a.status=1", con);
            {
                MySqlDataReader reader = cmd.ExecuteReader();
                DataTable dtData = new DataTable();
                dtData.Load(reader);
                return dtData;
                con.Close();
            }
            con.Close();
        }






        private void Mortality()
        {
            MySqlConnection con = new MySqlConnection(constr);
            try
            {
                con.Open();
                MySqlCommand cmd = new MySqlCommand("SELECT TableA.*,TableB.year_2019,TableC.year_2020 FROM mortality AS TableA   LEFT JOIN  (SELECT 'Yearly live births' AS FIELD, 'high mortality' AS cluster_type,COUNT(*) year_2019  FROM view_form1 WHERE form1_q24='1' AND DATE_FORMAT(STR_TO_DATE(form1_q18, '%d-%m-%Y'),'%Y')='2019' AND ((pw_block BETWEEN '01' AND '20') OR (pw_block BETWEEN '35' AND '37')) UNION ALL SELECT 'Yearly live births' AS FIELD, 'low mortality' AS cluster_type,COUNT(*) year_2019  FROM view_form1 WHERE form1_q24='1' AND DATE_FORMAT(STR_TO_DATE(form1_q18, '%d-%m-%Y'),'%Y')='2019' AND ((pw_block BETWEEN '21' AND '34') OR pw_block >='38') UNION ALL SELECT 'Yearly live births' AS FIELD, 'cumulative' AS cluster_type,COUNT(*) year_2019  FROM view_form1 WHERE form1_q24='1' AND DATE_FORMAT(STR_TO_DATE(form1_q18, '%d-%m-%Y'),'%Y')='2019' UNION ALL SELECT 'Number of under 5 deaths' AS FIELD, 'high mortality' AS cluster_type,COUNT(*) year_2019  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2019' AND ((MID(va_g1_1,5,2) BETWEEN '01' AND '20') OR (MID(va_g1_1,5,2) BETWEEN '35' AND '37')) AND  (TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) <1825 	AND (ABS(STR_TO_DATE(CONCAT(DATE_FORMAT(STR_TO_DATE(va_g1_5,'%d-%m-%Y'),'%d-%m-%Y'),' ', STR_TO_DATE(va_g1_5_time,  '%H:%i')),'%d-%m-%Y %H:%i')) - ABS(STR_TO_DATE(CONCAT(DATE_FORMAT(STR_TO_DATE(va_g1_4,'%d-%m-%Y'),'%d-%m-%Y'),' ', STR_TO_DATE(va_g1_4_time,  '%H:%i')),'%d-%m-%Y %H:%i'))) >0 UNION ALL SELECT 'Number of under 5 deaths' AS FIELD, 'low mortality' AS cluster_type,COUNT(*) year_2019  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2019' AND ((MID(va_g1_1,5,2) BETWEEN '21' AND '34') OR MID(va_g1_1,5,2) >='38') AND  (TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) <1825		AND (ABS(STR_TO_DATE(CONCAT(DATE_FORMAT(STR_TO_DATE(va_g1_5,'%d-%m-%Y'),'%d-%m-%Y'),' ', STR_TO_DATE(va_g1_5_time,  '%H:%i')),'%d-%m-%Y %H:%i')) - ABS(STR_TO_DATE(CONCAT(DATE_FORMAT(STR_TO_DATE(va_g1_4,'%d-%m-%Y'),'%d-%m-%Y'),' ', STR_TO_DATE(va_g1_4_time,  '%H:%i')),'%d-%m-%Y %H:%i'))) >0 UNION ALL SELECT 'Number of under 5 deaths' AS FIELD, 'cumulative' AS cluster_type,COUNT(*) year_2019  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2019' AND  (TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) <1825		AND (ABS(STR_TO_DATE(CONCAT(DATE_FORMAT(STR_TO_DATE(va_g1_5,'%d-%m-%Y'),'%d-%m-%Y'),' ', STR_TO_DATE(va_g1_5_time,  '%H:%i')),'%d-%m-%Y %H:%i')) - ABS(STR_TO_DATE(CONCAT(DATE_FORMAT(STR_TO_DATE(va_g1_4,'%d-%m-%Y'),'%d-%m-%Y'),' ', STR_TO_DATE(va_g1_4_time,  '%H:%i')),'%d-%m-%Y %H:%i'))) >0 UNION ALL SELECT 'under 5 mortality rates per 1000 live births' AS FIELD, 'high mortality' AS cluster_type, ROUND(((SELECT COUNT(*)  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2019' AND ((MID(va_g1_1,5,2) BETWEEN '01' AND '20') OR (MID(va_g1_1,5,2) BETWEEN '35' AND '37')) AND  (TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) <1825 	AND (ABS(STR_TO_DATE(CONCAT(DATE_FORMAT(STR_TO_DATE(va_g1_5,'%d-%m-%Y'),'%d-%m-%Y'),' ', STR_TO_DATE(va_g1_5_time,  '%H:%i')),'%d-%m-%Y %H:%i')) - ABS(STR_TO_DATE(CONCAT(DATE_FORMAT(STR_TO_DATE(va_g1_4,'%d-%m-%Y'),'%d-%m-%Y'),' ', STR_TO_DATE(va_g1_4_time,  '%H:%i')),'%d-%m-%Y %H:%i'))) >0) 	/  (SELECT COUNT(*)   FROM view_form1 WHERE form1_q24='1' AND DATE_FORMAT(STR_TO_DATE(form1_q18, '%d-%m-%Y'),'%Y')='2019' AND ((pw_block BETWEEN '01' AND '20') OR (pw_block BETWEEN '35' AND '37')))   ) * 1000,  0) AS year_2019 UNION ALL SELECT 'under 5 mortality rates per 1000 live births' AS FIELD, 'low mortality' AS cluster_type, ROUND(((SELECT COUNT(*)  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2019' AND ((MID(va_g1_1,5,2) BETWEEN '21' AND '34') OR MID(va_g1_1,5,2) >='38')  AND  (TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) <1825 	AND (ABS(STR_TO_DATE(CONCAT(DATE_FORMAT(STR_TO_DATE(va_g1_5,'%d-%m-%Y'),'%d-%m-%Y'),' ', STR_TO_DATE(va_g1_5_time,  '%H:%i')),'%d-%m-%Y %H:%i')) - ABS(STR_TO_DATE(CONCAT(DATE_FORMAT(STR_TO_DATE(va_g1_4,'%d-%m-%Y'),'%d-%m-%Y'),' ', STR_TO_DATE(va_g1_4_time,  '%H:%i')),'%d-%m-%Y %H:%i'))) >0) 	/  (SELECT COUNT(*)   FROM view_form1 WHERE form1_q24='1' AND DATE_FORMAT(STR_TO_DATE(form1_q18, '%d-%m-%Y'),'%Y')='2019' AND ((pw_block BETWEEN '21' AND '34') OR pw_block >='38'))   ) * 1000,  0) AS year_2019	 UNION ALL SELECT 'under 5 mortality rates per 1000 live births' AS FIELD, 'cumulative' AS cluster_type, ROUND(((SELECT COUNT(*)  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2019' AND (TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) <1825	 	AND (ABS(STR_TO_DATE(CONCAT(DATE_FORMAT(STR_TO_DATE(va_g1_5,'%d-%m-%Y'),'%d-%m-%Y'),' ', STR_TO_DATE(va_g1_5_time,  '%H:%i')),'%d-%m-%Y %H:%i')) - ABS(STR_TO_DATE(CONCAT(DATE_FORMAT(STR_TO_DATE(va_g1_4,'%d-%m-%Y'),'%d-%m-%Y'),' ', STR_TO_DATE(va_g1_4_time,  '%H:%i')),'%d-%m-%Y %H:%i'))) >0) 	/  (SELECT COUNT(*)   FROM view_form1 WHERE form1_q24='1' AND DATE_FORMAT(STR_TO_DATE(form1_q18, '%d-%m-%Y'),'%Y')='2019')   ) * 1000,  0) AS year_2019	 UNION ALL SELECT '(24-59) Month death' AS FIELD, 'high mortality' AS cluster_type,COUNT(*) year_2019  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2019' AND ((MID(va_g1_1,5,2) BETWEEN '01' AND '20') OR (MID(va_g1_1,5,2) BETWEEN '35' AND '37')) AND  ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) BETWEEN '700' AND '1794') UNION ALL SELECT '(24-59) Month death' AS FIELD, 'low mortality' AS cluster_type,COUNT(*) year_2019  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2019' AND ((MID(va_g1_1,5,2) BETWEEN '21' AND '34') OR MID(va_g1_1,5,2) >='38') AND ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) BETWEEN '700' AND '1794') UNION ALL SELECT '(24-59) Month death' AS FIELD, 'cumulative' AS cluster_type,COUNT(*) year_2019  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2019' AND ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) BETWEEN '700' AND '1794')  UNION ALL SELECT '(24-59) month mortality Rates' AS FIELD, 'high mortality' AS cluster_type, ROUND(((SELECT COUNT(*)  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2019' AND ((MID(va_g1_1,5,2) BETWEEN '01' AND '20') OR (MID(va_g1_1,5,2) BETWEEN '35' AND '37')) AND  ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) BETWEEN '700' AND '1794')) 	/  (SELECT COUNT(*)   FROM view_form1 WHERE form1_q24='1' AND DATE_FORMAT(STR_TO_DATE(form1_q18, '%d-%m-%Y'),'%Y')='2019' AND ((pw_block BETWEEN '01' AND '20') OR (pw_block BETWEEN '35' AND '37')))   ) * 1000,  0) AS year_2019 UNION ALL SELECT '(24-59) month mortality Rates' AS FIELD, 'low mortality' AS cluster_type, ROUND(((SELECT COUNT(*)  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2019' AND ((MID(va_g1_1,5,2) BETWEEN '21' AND '34') OR MID(va_g1_1,5,2) >='38')  AND  ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) BETWEEN '700' AND '1794')) 	/  (SELECT COUNT(*)   FROM view_form1 WHERE form1_q24='1' AND DATE_FORMAT(STR_TO_DATE(form1_q18, '%d-%m-%Y'),'%Y')='2019' AND ((pw_block BETWEEN '21' AND '34') OR pw_block >='38'))   ) * 1000,  0) AS year_2019	 UNION ALL SELECT '(24-59) month mortality Rates' AS FIELD, 'cumulative' AS cluster_type, ROUND(((SELECT COUNT(*)  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2019' AND ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) BETWEEN '700' AND '1794')) 	/  (SELECT COUNT(*)   FROM view_form1 WHERE form1_q24='1' AND DATE_FORMAT(STR_TO_DATE(form1_q18, '%d-%m-%Y'),'%Y')='2019')   ) * 1000,  0) AS year_2019	 UNION ALL SELECT '(12-23) month  deaths' AS FIELD, 'high mortality' AS cluster_type,COUNT(*) year_2019  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2019' AND ((MID(va_g1_1,5,2) BETWEEN '01' AND '20') OR (MID(va_g1_1,5,2) BETWEEN '35' AND '37')) AND  ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) BETWEEN '335' AND '699') UNION ALL SELECT '(12-23) month  deaths' AS FIELD, 'low mortality' AS cluster_type,COUNT(*) year_2019  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2019' AND ((MID(va_g1_1,5,2) BETWEEN '21' AND '34') OR MID(va_g1_1,5,2) >='38') AND ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) BETWEEN '335' AND '699') UNION ALL SELECT '(12-23) month  deaths' AS FIELD, 'cumulative' AS cluster_type,COUNT(*) year_2019  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2019' AND ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) BETWEEN '335' AND '699') UNION ALL SELECT '(12-23) month  mortality rates' AS FIELD, 'high mortality' AS cluster_type, ROUND(((SELECT COUNT(*)  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2019' AND ((MID(va_g1_1,5,2) BETWEEN '01' AND '20') OR (MID(va_g1_1,5,2) BETWEEN '35' AND '37')) AND  ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) BETWEEN '335' AND '699')) 	/  (SELECT COUNT(*)   FROM view_form1 WHERE form1_q24='1' AND DATE_FORMAT(STR_TO_DATE(form1_q18, '%d-%m-%Y'),'%Y')='2019' AND ((pw_block BETWEEN '01' AND '20') OR (pw_block BETWEEN '35' AND '37')))   ) * 1000,  0) AS year_2019 UNION ALL SELECT '(12-23) month  mortality rates' AS FIELD, 'low mortality' AS cluster_type, ROUND(((SELECT COUNT(*)  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2019' AND ((MID(va_g1_1,5,2) BETWEEN '21' AND '34') OR MID(va_g1_1,5,2) >='38')  AND  ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) BETWEEN '335' AND '699')) 	/  (SELECT COUNT(*)   FROM view_form1 WHERE form1_q24='1' AND DATE_FORMAT(STR_TO_DATE(form1_q18, '%d-%m-%Y'),'%Y')='2019' AND ((pw_block BETWEEN '21' AND '34') OR pw_block >='38'))   ) * 1000,  0) AS year_2019 UNION ALL SELECT '(12-23) month  mortality rates' AS FIELD, 'cumulative' AS cluster_type, ROUND(((SELECT COUNT(*)  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2019' AND ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) BETWEEN '335' AND '699')) 	/  (SELECT COUNT(*)   FROM view_form1 WHERE form1_q24='1' AND DATE_FORMAT(STR_TO_DATE(form1_q18, '%d-%m-%Y'),'%Y')='2019')   ) * 1000,  0) AS year_2019	 UNION ALL SELECT '(6-11) month death' AS FIELD, 'high mortality' AS cluster_type,COUNT(*) year_2019  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2019' AND ((MID(va_g1_1,5,2) BETWEEN '01' AND '20') OR (MID(va_g1_1,5,2) BETWEEN '35' AND '37')) AND  ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) BETWEEN '153' AND '334') UNION ALL SELECT '(6-11) month death' AS FIELD, 'low mortality' AS cluster_type,COUNT(*) year_2019  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2019' AND ((MID(va_g1_1,5,2) BETWEEN '21' AND '34') OR MID(va_g1_1,5,2) >='38') AND ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) BETWEEN  '153' AND '334') UNION ALL SELECT '(6-11) month death' AS FIELD, 'cumulative' AS cluster_type,COUNT(*) year_2019  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2019' AND ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) BETWEEN  '153' AND '334') UNION ALL SELECT '(6-11) month mortality rates' AS FIELD, 'high mortality' AS cluster_type, ROUND(((SELECT COUNT(*)  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2019' AND ((MID(va_g1_1,5,2) BETWEEN '01' AND '20') OR (MID(va_g1_1,5,2) BETWEEN '35' AND '37')) AND  ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) BETWEEN  '153' AND '334')) 	/  (SELECT COUNT(*)   FROM view_form1 WHERE form1_q24='1' AND DATE_FORMAT(STR_TO_DATE(form1_q18, '%d-%m-%Y'),'%Y')='2019' AND ((pw_block BETWEEN '01' AND '20') OR (pw_block BETWEEN '35' AND '37')))   ) * 1000,  0) AS year_2019 UNION ALL SELECT '(6-11) month mortality rates' AS FIELD, 'low mortality' AS cluster_type, ROUND(((SELECT COUNT(*)  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2019' AND ((MID(va_g1_1,5,2) BETWEEN '21' AND '34') OR MID(va_g1_1,5,2) >='38')  AND  ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) BETWEEN  '153' AND '334')) 	/  (SELECT COUNT(*)   FROM view_form1 WHERE form1_q24='1' AND DATE_FORMAT(STR_TO_DATE(form1_q18, '%d-%m-%Y'),'%Y')='2019' AND ((pw_block BETWEEN '21' AND '34') OR pw_block >='38'))   ) * 1000,  0) AS year_2019 UNION ALL SELECT '(6-11) month mortality rates' AS FIELD, 'cumulative' AS cluster_type, ROUND(((SELECT COUNT(*)  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2019' AND ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) BETWEEN  '153' AND '334')) 	/  (SELECT COUNT(*)   FROM view_form1 WHERE form1_q24='1' AND DATE_FORMAT(STR_TO_DATE(form1_q18, '%d-%m-%Y'),'%Y')='2019')   ) * 1000,  0) AS year_2019	 UNION ALL SELECT '(2-5) month death' AS FIELD, 'high mortality' AS cluster_type,COUNT(*) year_2019  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2019' AND ((MID(va_g1_1,5,2) BETWEEN '01' AND '20') OR (MID(va_g1_1,5,2) BETWEEN '35' AND '37')) AND  ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) BETWEEN '60' AND '152') UNION ALL SELECT '(2-5) month death' AS FIELD, 'low mortality' AS cluster_type,COUNT(*) year_2019  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2019' AND ((MID(va_g1_1,5,2) BETWEEN '21' AND '34') OR MID(va_g1_1,5,2) >='38') AND ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) BETWEEN   '60' AND '152') UNION ALL SELECT '(2-5) month death' AS FIELD, 'cumulative' AS cluster_type,COUNT(*) year_2019  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2019' AND ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) BETWEEN   '60' AND '152') UNION ALL SELECT '(2-5) month mortality rate' AS FIELD, 'high mortality' AS cluster_type, ROUND(((SELECT COUNT(*)  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2019' AND ((MID(va_g1_1,5,2) BETWEEN '01' AND '20') OR (MID(va_g1_1,5,2) BETWEEN '35' AND '37')) AND  ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) BETWEEN   '60' AND '152')) 	/  (SELECT COUNT(*)   FROM view_form1 WHERE form1_q24='1' AND DATE_FORMAT(STR_TO_DATE(form1_q18, '%d-%m-%Y'),'%Y')='2019' AND ((pw_block BETWEEN '01' AND '20') OR (pw_block BETWEEN '35' AND '37')))   ) * 1000,  0) AS year_2019 UNION ALL SELECT '(2-5) month mortality rate' AS FIELD, 'low mortality' AS cluster_type, ROUND(((SELECT COUNT(*)  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2019' AND ((MID(va_g1_1,5,2) BETWEEN '21' AND '34') OR MID(va_g1_1,5,2) >='38')  AND  ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) BETWEEN   '60' AND '152')) 	/  (SELECT COUNT(*)   FROM view_form1 WHERE form1_q24='1' AND DATE_FORMAT(STR_TO_DATE(form1_q18, '%d-%m-%Y'),'%Y')='2019' AND ((pw_block BETWEEN '21' AND '34') OR pw_block >='38'))   ) * 1000,  0) AS year_2019 UNION ALL SELECT '(2-5) month mortality rate' AS FIELD, 'cumulative' AS cluster_type, ROUND(((SELECT COUNT(*)  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2019' AND ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) BETWEEN   '60' AND '152')) 	/  (SELECT COUNT(*)   FROM view_form1 WHERE form1_q24='1' AND DATE_FORMAT(STR_TO_DATE(form1_q18, '%d-%m-%Y'),'%Y')='2019')   ) * 1000,  0) AS year_2019	 UNION ALL SELECT '(28-59) days death' AS FIELD, 'high mortality' AS cluster_type,COUNT(*) year_2019  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2019' AND ((MID(va_g1_1,5,2) BETWEEN '01' AND '20') OR (MID(va_g1_1,5,2) BETWEEN '35' AND '37')) AND  ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) BETWEEN '28' AND '59') UNION ALL SELECT '(28-59) days death' AS FIELD, 'low mortality' AS cluster_type,COUNT(*) year_2019  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2019' AND ((MID(va_g1_1,5,2) BETWEEN '21' AND '34') OR MID(va_g1_1,5,2) >='38') AND ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) BETWEEN   '28' AND '59') UNION ALL SELECT '(28-59) days death' AS FIELD, 'cumulative' AS cluster_type,COUNT(*) year_2019  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2019' AND ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) BETWEEN   '28' AND '59') UNION ALL SELECT '(28-59) days mortality rate' AS FIELD, 'high mortality' AS cluster_type, ROUND(((SELECT COUNT(*)  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2019' AND ((MID(va_g1_1,5,2) BETWEEN '01' AND '20') OR (MID(va_g1_1,5,2) BETWEEN '35' AND '37')) AND  ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) BETWEEN   '28' AND '59')) 	/  (SELECT COUNT(*)   FROM view_form1 WHERE form1_q24='1' AND DATE_FORMAT(STR_TO_DATE(form1_q18, '%d-%m-%Y'),'%Y')='2019' AND ((pw_block BETWEEN '01' AND '20') OR (pw_block BETWEEN '35' AND '37')))   ) * 1000,  0) AS year_2019 UNION ALL SELECT '(28-59) days mortality rate' AS FIELD, 'low mortality' AS cluster_type, ROUND(((SELECT COUNT(*)  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2019' AND ((MID(va_g1_1,5,2) BETWEEN '21' AND '34') OR MID(va_g1_1,5,2) >='38')  AND  ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) BETWEEN   '28' AND '59')) 	/  (SELECT COUNT(*)   FROM view_form1 WHERE form1_q24='1' AND DATE_FORMAT(STR_TO_DATE(form1_q18, '%d-%m-%Y'),'%Y')='2019' AND ((pw_block BETWEEN '21' AND '34') OR pw_block >='38'))   ) * 1000,  0) AS year_2019 UNION ALL SELECT '(28-59) days mortality rate' AS FIELD, 'cumulative' AS cluster_type, ROUND(((SELECT COUNT(*)  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2019' AND ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) BETWEEN   '28' AND '59')) 	/  (SELECT COUNT(*)   FROM view_form1 WHERE form1_q24='1' AND DATE_FORMAT(STR_TO_DATE(form1_q18, '%d-%m-%Y'),'%Y')='2019')   ) * 1000,  0) AS year_2019	 UNION ALL SELECT 'number of neonatal deaths' AS FIELD, 'high mortality' AS cluster_type,COUNT(*) year_2019  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2019' AND ((MID(va_g1_1,5,2) BETWEEN '01' AND '20') OR (MID(va_g1_1,5,2) BETWEEN '35' AND '37')) AND  ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y')))   <=27  AND (ABS(STR_TO_DATE(CONCAT(DATE_FORMAT(STR_TO_DATE(va_g1_5,'%d-%m-%Y'),'%d-%m-%Y'),' ', STR_TO_DATE(va_g1_5_time,  '%H:%i')),'%d-%m-%Y %H:%i')) - ABS(STR_TO_DATE(CONCAT(DATE_FORMAT(STR_TO_DATE(va_g1_4,'%d-%m-%Y'),'%d-%m-%Y'),' ', STR_TO_DATE(va_g1_4_time,  '%H:%i')),'%d-%m-%Y %H:%i'))) >0 ) UNION ALL SELECT 'number of neonatal deaths' AS FIELD, 'low mortality' AS cluster_type,COUNT(*) year_2019  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2019' AND ((MID(va_g1_1,5,2) BETWEEN '21' AND '34') OR MID(va_g1_1,5,2) >='38') AND ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y')))    <=27  AND (ABS(STR_TO_DATE(CONCAT(DATE_FORMAT(STR_TO_DATE(va_g1_5,'%d-%m-%Y'),'%d-%m-%Y'),' ', STR_TO_DATE(va_g1_5_time,  '%H:%i')),'%d-%m-%Y %H:%i')) - ABS(STR_TO_DATE(CONCAT(DATE_FORMAT(STR_TO_DATE(va_g1_4,'%d-%m-%Y'),'%d-%m-%Y'),' ', STR_TO_DATE(va_g1_4_time,  '%H:%i')),'%d-%m-%Y %H:%i'))) >0 ) UNION ALL SELECT 'number of neonatal deaths' AS FIELD, 'cumulative' AS cluster_type,COUNT(*) year_2019  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2019' AND ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y')))    <=27  AND (ABS(STR_TO_DATE(CONCAT(DATE_FORMAT(STR_TO_DATE(va_g1_5,'%d-%m-%Y'),'%d-%m-%Y'),' ', STR_TO_DATE(va_g1_5_time,  '%H:%i')),'%d-%m-%Y %H:%i')) - ABS(STR_TO_DATE(CONCAT(DATE_FORMAT(STR_TO_DATE(va_g1_4,'%d-%m-%Y'),'%d-%m-%Y'),' ', STR_TO_DATE(va_g1_4_time,  '%H:%i')),'%d-%m-%Y %H:%i'))) >0 )  UNION ALL SELECT 'Neonatal mortality rate' AS FIELD, 'high mortality' AS cluster_type, ROUND(((SELECT COUNT(*)  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2019' AND ((MID(va_g1_1,5,2) BETWEEN '01' AND '20') OR (MID(va_g1_1,5,2) BETWEEN '35' AND '37')) AND  ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y')))    <=27  AND (ABS(STR_TO_DATE(CONCAT(DATE_FORMAT(STR_TO_DATE(va_g1_5,'%d-%m-%Y'),'%d-%m-%Y'),' ', STR_TO_DATE(va_g1_5_time,  '%H:%i')),'%d-%m-%Y %H:%i')) - ABS(STR_TO_DATE(CONCAT(DATE_FORMAT(STR_TO_DATE(va_g1_4,'%d-%m-%Y'),'%d-%m-%Y'),' ', STR_TO_DATE(va_g1_4_time,  '%H:%i')),'%d-%m-%Y %H:%i'))) >0 )) 	/  (SELECT COUNT(*)   FROM view_form1 WHERE form1_q24='1' AND DATE_FORMAT(STR_TO_DATE(form1_q18, '%d-%m-%Y'),'%Y')='2019' AND ((pw_block BETWEEN '01' AND '20') OR (pw_block BETWEEN '35' AND '37')))   ) * 1000,  0) AS year_2019 UNION ALL SELECT 'Neonatal mortality rate' AS FIELD, 'low mortality' AS cluster_type, ROUND(((SELECT COUNT(*)  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2019' AND ((MID(va_g1_1,5,2) BETWEEN '21' AND '34') OR MID(va_g1_1,5,2) >='38')  AND  ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y')))     <=27  AND (ABS(STR_TO_DATE(CONCAT(DATE_FORMAT(STR_TO_DATE(va_g1_5,'%d-%m-%Y'),'%d-%m-%Y'),' ', STR_TO_DATE(va_g1_5_time,  '%H:%i')),'%d-%m-%Y %H:%i')) - ABS(STR_TO_DATE(CONCAT(DATE_FORMAT(STR_TO_DATE(va_g1_4,'%d-%m-%Y'),'%d-%m-%Y'),' ', STR_TO_DATE(va_g1_4_time,  '%H:%i')),'%d-%m-%Y %H:%i'))) >0 )) 	/  (SELECT COUNT(*)   FROM view_form1 WHERE form1_q24='1' AND DATE_FORMAT(STR_TO_DATE(form1_q18, '%d-%m-%Y'),'%Y')='2019' AND ((pw_block BETWEEN '21' AND '34') OR pw_block >='38'))   ) * 1000,  0) AS year_2019 UNION ALL SELECT 'Neonatal mortality rate' AS FIELD, 'cumulative' AS cluster_type, ROUND(((SELECT COUNT(*)  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2019' AND ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y')))     <=27  AND (ABS(STR_TO_DATE(CONCAT(DATE_FORMAT(STR_TO_DATE(va_g1_5,'%d-%m-%Y'),'%d-%m-%Y'),' ', STR_TO_DATE(va_g1_5_time,  '%H:%i')),'%d-%m-%Y %H:%i')) - ABS(STR_TO_DATE(CONCAT(DATE_FORMAT(STR_TO_DATE(va_g1_4,'%d-%m-%Y'),'%d-%m-%Y'),' ', STR_TO_DATE(va_g1_4_time,  '%H:%i')),'%d-%m-%Y %H:%i'))) >0 )) 	/  (SELECT COUNT(*)   FROM view_form1 WHERE form1_q24='1' AND DATE_FORMAT(STR_TO_DATE(form1_q18, '%d-%m-%Y'),'%Y')='2019')   ) * 1000,  0) AS year_2019	 UNION ALL SELECT 'number of day zero neonatal deaths' AS FIELD, 'high mortality' AS cluster_type,COUNT(*) year_2019  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2019' AND ((MID(va_g1_1,5,2) BETWEEN '01' AND '20') OR (MID(va_g1_1,5,2) BETWEEN '35' AND '37')) AND  ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) =0  AND (ABS(STR_TO_DATE(CONCAT(DATE_FORMAT(STR_TO_DATE(va_g1_5,'%d-%m-%Y'),'%d-%m-%Y'),' ', STR_TO_DATE(va_g1_5_time,  '%H:%i')),'%d-%m-%Y %H:%i')) - ABS(STR_TO_DATE(CONCAT(DATE_FORMAT(STR_TO_DATE(va_g1_4,'%d-%m-%Y'),'%d-%m-%Y'),' ', STR_TO_DATE(va_g1_4_time,  '%H:%i')),'%d-%m-%Y %H:%i'))) >0 ) UNION ALL SELECT 'number of day zero neonatal deaths' AS FIELD, 'low mortality' AS cluster_type,COUNT(*) year_2019  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2019' AND ((MID(va_g1_1,5,2) BETWEEN '21' AND '34') OR MID(va_g1_1,5,2) >='38') AND ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y')))    =0    AND (ABS(STR_TO_DATE(CONCAT(DATE_FORMAT(STR_TO_DATE(va_g1_5,'%d-%m-%Y'),'%d-%m-%Y'),' ', STR_TO_DATE(va_g1_5_time,  '%H:%i')),'%d-%m-%Y %H:%i')) - ABS(STR_TO_DATE(CONCAT(DATE_FORMAT(STR_TO_DATE(va_g1_4,'%d-%m-%Y'),'%d-%m-%Y'),' ', STR_TO_DATE(va_g1_4_time,  '%H:%i')),'%d-%m-%Y %H:%i'))) >0 ) UNION ALL SELECT 'number of day zero neonatal deaths' AS FIELD, 'cumulative' AS cluster_type,COUNT(*) year_2019  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2019' AND ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) =0    AND (ABS(STR_TO_DATE(CONCAT(DATE_FORMAT(STR_TO_DATE(va_g1_5,'%d-%m-%Y'),'%d-%m-%Y'),' ', STR_TO_DATE(va_g1_5_time,  '%H:%i')),'%d-%m-%Y %H:%i')) - ABS(STR_TO_DATE(CONCAT(DATE_FORMAT(STR_TO_DATE(va_g1_4,'%d-%m-%Y'),'%d-%m-%Y'),' ', STR_TO_DATE(va_g1_4_time,  '%H:%i')),'%d-%m-%Y %H:%i'))) >0 ) UNION ALL SELECT 'Day zero Neonatal mortality rate' AS FIELD, 'high mortality' AS cluster_type, ROUND(((SELECT COUNT(*)  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2019' AND ((MID(va_g1_1,5,2) BETWEEN '01' AND '20') OR (MID(va_g1_1,5,2) BETWEEN '35' AND '37')) AND  ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) =0    AND (ABS(STR_TO_DATE(CONCAT(DATE_FORMAT(STR_TO_DATE(va_g1_5,'%d-%m-%Y'),'%d-%m-%Y'),' ', STR_TO_DATE(va_g1_5_time,  '%H:%i')),'%d-%m-%Y %H:%i')) - ABS(STR_TO_DATE(CONCAT(DATE_FORMAT(STR_TO_DATE(va_g1_4,'%d-%m-%Y'),'%d-%m-%Y'),' ', STR_TO_DATE(va_g1_4_time,  '%H:%i')),'%d-%m-%Y %H:%i'))) >0 )) 	/  (SELECT COUNT(*)   FROM view_form1 WHERE form1_q24='1' AND DATE_FORMAT(STR_TO_DATE(form1_q18, '%d-%m-%Y'),'%Y')='2019' AND ((pw_block BETWEEN '01' AND '20') OR (pw_block BETWEEN '35' AND '37')))   ) * 1000,  0) AS year_2019 UNION ALL SELECT 'Day zero Neonatal mortality rate' AS FIELD, 'low mortality' AS cluster_type, ROUND(((SELECT COUNT(*)  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2019' AND ((MID(va_g1_1,5,2) BETWEEN '21' AND '34') OR MID(va_g1_1,5,2) >='38')  AND  ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) =0    AND (ABS(STR_TO_DATE(CONCAT(DATE_FORMAT(STR_TO_DATE(va_g1_5,'%d-%m-%Y'),'%d-%m-%Y'),' ', STR_TO_DATE(va_g1_5_time,  '%H:%i')),'%d-%m-%Y %H:%i')) - ABS(STR_TO_DATE(CONCAT(DATE_FORMAT(STR_TO_DATE(va_g1_4,'%d-%m-%Y'),'%d-%m-%Y'),' ', STR_TO_DATE(va_g1_4_time,  '%H:%i')),'%d-%m-%Y %H:%i'))) >0 )) 	/  (SELECT COUNT(*)   FROM view_form1 WHERE form1_q24='1' AND DATE_FORMAT(STR_TO_DATE(form1_q18, '%d-%m-%Y'),'%Y')='2019' AND ((pw_block BETWEEN '21' AND '34') OR pw_block >='38'))   ) * 1000,  0) AS year_2019 UNION ALL SELECT 'Day zero Neonatal mortality rate' AS FIELD, 'cumulative' AS cluster_type, ROUND(((SELECT COUNT(*)  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2019' AND ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) =0    AND (ABS(STR_TO_DATE(CONCAT(DATE_FORMAT(STR_TO_DATE(va_g1_5,'%d-%m-%Y'),'%d-%m-%Y'),' ', STR_TO_DATE(va_g1_5_time,  '%H:%i')),'%d-%m-%Y %H:%i')) - ABS(STR_TO_DATE(CONCAT(DATE_FORMAT(STR_TO_DATE(va_g1_4,'%d-%m-%Y'),'%d-%m-%Y'),' ', STR_TO_DATE(va_g1_4_time,  '%H:%i')),'%d-%m-%Y %H:%i'))) >0 )) 	/  (SELECT COUNT(*)   FROM view_form1 WHERE form1_q24='1' AND DATE_FORMAT(STR_TO_DATE(form1_q18, '%d-%m-%Y'),'%Y')='2019')   ) * 1000,  0) AS year_2019	 ) TableB ON TableA.field=TableB.field AND TableA.cluster_type=TableB.cluster_type LEFT JOIN  (SELECT 'Yearly live births' AS FIELD, 'high mortality' AS cluster_type,COUNT(*) year_2020  FROM view_form1 WHERE form1_q24='1' AND DATE_FORMAT(STR_TO_DATE(form1_q18, '%d-%m-%Y'),'%Y')='2020' AND ((pw_block BETWEEN '01' AND '20') OR (pw_block BETWEEN '35' AND '37')) UNION ALL SELECT 'Yearly live births' AS FIELD, 'low mortality' AS cluster_type,COUNT(*) year_2020  FROM view_form1 WHERE form1_q24='1' AND DATE_FORMAT(STR_TO_DATE(form1_q18, '%d-%m-%Y'),'%Y')='2020' AND ((pw_block BETWEEN '21' AND '34') OR pw_block >='38') UNION ALL SELECT 'Yearly live births' AS FIELD, 'cumulative' AS cluster_type,COUNT(*) year_2020  FROM view_form1 WHERE form1_q24='1' AND DATE_FORMAT(STR_TO_DATE(form1_q18, '%d-%m-%Y'),'%Y')='2020' UNION ALL SELECT 'Number of under 5 deaths' AS FIELD, 'high mortality' AS cluster_type,COUNT(*) year_2020  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2020' AND ((MID(va_g1_1,5,2) BETWEEN '01' AND '20') OR (MID(va_g1_1,5,2) BETWEEN '35' AND '37')) AND  (TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) <1825 	AND (ABS(STR_TO_DATE(CONCAT(DATE_FORMAT(STR_TO_DATE(va_g1_5,'%d-%m-%Y'),'%d-%m-%Y'),' ', STR_TO_DATE(va_g1_5_time,  '%H:%i')),'%d-%m-%Y %H:%i')) - ABS(STR_TO_DATE(CONCAT(DATE_FORMAT(STR_TO_DATE(va_g1_4,'%d-%m-%Y'),'%d-%m-%Y'),' ', STR_TO_DATE(va_g1_4_time,  '%H:%i')),'%d-%m-%Y %H:%i'))) >0 UNION ALL SELECT 'Number of under 5 deaths' AS FIELD, 'low mortality' AS cluster_type,COUNT(*) year_2020  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2020' AND ((MID(va_g1_1,5,2) BETWEEN '21' AND '34') OR MID(va_g1_1,5,2) >='38') AND  (TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) <1825		AND (ABS(STR_TO_DATE(CONCAT(DATE_FORMAT(STR_TO_DATE(va_g1_5,'%d-%m-%Y'),'%d-%m-%Y'),' ', STR_TO_DATE(va_g1_5_time,  '%H:%i')),'%d-%m-%Y %H:%i')) - ABS(STR_TO_DATE(CONCAT(DATE_FORMAT(STR_TO_DATE(va_g1_4,'%d-%m-%Y'),'%d-%m-%Y'),' ', STR_TO_DATE(va_g1_4_time,  '%H:%i')),'%d-%m-%Y %H:%i'))) >0 UNION ALL SELECT 'Number of under 5 deaths' AS FIELD, 'cumulative' AS cluster_type,COUNT(*) year_2020  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2020' AND  (TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) <1825		AND (ABS(STR_TO_DATE(CONCAT(DATE_FORMAT(STR_TO_DATE(va_g1_5,'%d-%m-%Y'),'%d-%m-%Y'),' ', STR_TO_DATE(va_g1_5_time,  '%H:%i')),'%d-%m-%Y %H:%i')) - ABS(STR_TO_DATE(CONCAT(DATE_FORMAT(STR_TO_DATE(va_g1_4,'%d-%m-%Y'),'%d-%m-%Y'),' ', STR_TO_DATE(va_g1_4_time,  '%H:%i')),'%d-%m-%Y %H:%i'))) >0 UNION ALL SELECT 'under 5 mortality rates per 1000 live births' AS FIELD, 'high mortality' AS cluster_type, ROUND(((SELECT COUNT(*)  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2020' AND ((MID(va_g1_1,5,2) BETWEEN '01' AND '20') OR (MID(va_g1_1,5,2) BETWEEN '35' AND '37')) AND  (TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) <1825 	AND (ABS(STR_TO_DATE(CONCAT(DATE_FORMAT(STR_TO_DATE(va_g1_5,'%d-%m-%Y'),'%d-%m-%Y'),' ', STR_TO_DATE(va_g1_5_time,  '%H:%i')),'%d-%m-%Y %H:%i')) - ABS(STR_TO_DATE(CONCAT(DATE_FORMAT(STR_TO_DATE(va_g1_4,'%d-%m-%Y'),'%d-%m-%Y'),' ', STR_TO_DATE(va_g1_4_time,  '%H:%i')),'%d-%m-%Y %H:%i'))) >0) 	/  (SELECT COUNT(*)   FROM view_form1 WHERE form1_q24='1' AND DATE_FORMAT(STR_TO_DATE(form1_q18, '%d-%m-%Y'),'%Y')='2020' AND ((pw_block BETWEEN '01' AND '20') OR (pw_block BETWEEN '35' AND '37')))   ) * 1000,  0) AS year_2020 UNION ALL SELECT 'under 5 mortality rates per 1000 live births' AS FIELD, 'low mortality' AS cluster_type, ROUND(((SELECT COUNT(*)  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2020' AND ((MID(va_g1_1,5,2) BETWEEN '21' AND '34') OR MID(va_g1_1,5,2) >='38')  AND  (TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) <1825 	AND (ABS(STR_TO_DATE(CONCAT(DATE_FORMAT(STR_TO_DATE(va_g1_5,'%d-%m-%Y'),'%d-%m-%Y'),' ', STR_TO_DATE(va_g1_5_time,  '%H:%i')),'%d-%m-%Y %H:%i')) - ABS(STR_TO_DATE(CONCAT(DATE_FORMAT(STR_TO_DATE(va_g1_4,'%d-%m-%Y'),'%d-%m-%Y'),' ', STR_TO_DATE(va_g1_4_time,  '%H:%i')),'%d-%m-%Y %H:%i'))) >0) 	/  (SELECT COUNT(*)   FROM view_form1 WHERE form1_q24='1' AND DATE_FORMAT(STR_TO_DATE(form1_q18, '%d-%m-%Y'),'%Y')='2020' AND ((pw_block BETWEEN '21' AND '34') OR pw_block >='38'))   ) * 1000,  0) AS year_2020	 UNION ALL SELECT 'under 5 mortality rates per 1000 live births' AS FIELD, 'cumulative' AS cluster_type, ROUND(((SELECT COUNT(*)  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2020' AND (TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) <1825	 	AND (ABS(STR_TO_DATE(CONCAT(DATE_FORMAT(STR_TO_DATE(va_g1_5,'%d-%m-%Y'),'%d-%m-%Y'),' ', STR_TO_DATE(va_g1_5_time,  '%H:%i')),'%d-%m-%Y %H:%i')) - ABS(STR_TO_DATE(CONCAT(DATE_FORMAT(STR_TO_DATE(va_g1_4,'%d-%m-%Y'),'%d-%m-%Y'),' ', STR_TO_DATE(va_g1_4_time,  '%H:%i')),'%d-%m-%Y %H:%i'))) >0) 	/  (SELECT COUNT(*)   FROM view_form1 WHERE form1_q24='1' AND DATE_FORMAT(STR_TO_DATE(form1_q18, '%d-%m-%Y'),'%Y')='2020')   ) * 1000,  0) AS year_2020	 UNION ALL SELECT '(24-59) Month death' AS FIELD, 'high mortality' AS cluster_type,COUNT(*) year_2020  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2020' AND ((MID(va_g1_1,5,2) BETWEEN '01' AND '20') OR (MID(va_g1_1,5,2) BETWEEN '35' AND '37')) AND  ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) BETWEEN '700' AND '1794') UNION ALL SELECT '(24-59) Month death' AS FIELD, 'low mortality' AS cluster_type,COUNT(*) year_2020  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2020' AND ((MID(va_g1_1,5,2) BETWEEN '21' AND '34') OR MID(va_g1_1,5,2) >='38') AND ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) BETWEEN '700' AND '1794') UNION ALL SELECT '(24-59) Month death' AS FIELD, 'cumulative' AS cluster_type,COUNT(*) year_2020  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2020' AND ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) BETWEEN '700' AND '1794')  UNION ALL SELECT '(24-59) month mortality Rates' AS FIELD, 'high mortality' AS cluster_type, ROUND(((SELECT COUNT(*)  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2020' AND ((MID(va_g1_1,5,2) BETWEEN '01' AND '20') OR (MID(va_g1_1,5,2) BETWEEN '35' AND '37')) AND  ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) BETWEEN '700' AND '1794')) 	/  (SELECT COUNT(*)   FROM view_form1 WHERE form1_q24='1' AND DATE_FORMAT(STR_TO_DATE(form1_q18, '%d-%m-%Y'),'%Y')='2020' AND ((pw_block BETWEEN '01' AND '20') OR (pw_block BETWEEN '35' AND '37')))   ) * 1000,  0) AS year_2020 UNION ALL SELECT '(24-59) month mortality Rates' AS FIELD, 'low mortality' AS cluster_type, ROUND(((SELECT COUNT(*)  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2020' AND ((MID(va_g1_1,5,2) BETWEEN '21' AND '34') OR MID(va_g1_1,5,2) >='38')  AND  ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) BETWEEN '700' AND '1794')) 	/  (SELECT COUNT(*)   FROM view_form1 WHERE form1_q24='1' AND DATE_FORMAT(STR_TO_DATE(form1_q18, '%d-%m-%Y'),'%Y')='2020' AND ((pw_block BETWEEN '21' AND '34') OR pw_block >='38'))   ) * 1000,  0) AS year_2020	 UNION ALL SELECT '(24-59) month mortality Rates' AS FIELD, 'cumulative' AS cluster_type, ROUND(((SELECT COUNT(*)  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2020' AND ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) BETWEEN '700' AND '1794')) 	/  (SELECT COUNT(*)   FROM view_form1 WHERE form1_q24='1' AND DATE_FORMAT(STR_TO_DATE(form1_q18, '%d-%m-%Y'),'%Y')='2020')   ) * 1000,  0) AS year_2020	 UNION ALL SELECT '(12-23) month  deaths' AS FIELD, 'high mortality' AS cluster_type,COUNT(*) year_2020  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2020' AND ((MID(va_g1_1,5,2) BETWEEN '01' AND '20') OR (MID(va_g1_1,5,2) BETWEEN '35' AND '37')) AND  ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) BETWEEN '335' AND '699') UNION ALL SELECT '(12-23) month  deaths' AS FIELD, 'low mortality' AS cluster_type,COUNT(*) year_2020  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2020' AND ((MID(va_g1_1,5,2) BETWEEN '21' AND '34') OR MID(va_g1_1,5,2) >='38') AND ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) BETWEEN '335' AND '699') UNION ALL SELECT '(12-23) month  deaths' AS FIELD, 'cumulative' AS cluster_type,COUNT(*) year_2020  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2020' AND ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) BETWEEN '335' AND '699') UNION ALL SELECT '(12-23) month  mortality rates' AS FIELD, 'high mortality' AS cluster_type, ROUND(((SELECT COUNT(*)  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2020' AND ((MID(va_g1_1,5,2) BETWEEN '01' AND '20') OR (MID(va_g1_1,5,2) BETWEEN '35' AND '37')) AND  ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) BETWEEN '335' AND '699')) 	/  (SELECT COUNT(*)   FROM view_form1 WHERE form1_q24='1' AND DATE_FORMAT(STR_TO_DATE(form1_q18, '%d-%m-%Y'),'%Y')='2020' AND ((pw_block BETWEEN '01' AND '20') OR (pw_block BETWEEN '35' AND '37')))   ) * 1000,  0) AS year_2020 UNION ALL SELECT '(12-23) month  mortality rates' AS FIELD, 'low mortality' AS cluster_type, ROUND(((SELECT COUNT(*)  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2020' AND ((MID(va_g1_1,5,2) BETWEEN '21' AND '34') OR MID(va_g1_1,5,2) >='38')  AND  ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) BETWEEN '335' AND '699')) 	/  (SELECT COUNT(*)   FROM view_form1 WHERE form1_q24='1' AND DATE_FORMAT(STR_TO_DATE(form1_q18, '%d-%m-%Y'),'%Y')='2020' AND ((pw_block BETWEEN '21' AND '34') OR pw_block >='38'))   ) * 1000,  0) AS year_2020 UNION ALL SELECT '(12-23) month  mortality rates' AS FIELD, 'cumulative' AS cluster_type, ROUND(((SELECT COUNT(*)  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2020' AND ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) BETWEEN '335' AND '699')) 	/  (SELECT COUNT(*)   FROM view_form1 WHERE form1_q24='1' AND DATE_FORMAT(STR_TO_DATE(form1_q18, '%d-%m-%Y'),'%Y')='2020')   ) * 1000,  0) AS year_2020	 UNION ALL SELECT '(6-11) month death' AS FIELD, 'high mortality' AS cluster_type,COUNT(*) year_2020  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2020' AND ((MID(va_g1_1,5,2) BETWEEN '01' AND '20') OR (MID(va_g1_1,5,2) BETWEEN '35' AND '37')) AND  ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) BETWEEN '153' AND '334') UNION ALL SELECT '(6-11) month death' AS FIELD, 'low mortality' AS cluster_type,COUNT(*) year_2020  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2020' AND ((MID(va_g1_1,5,2) BETWEEN '21' AND '34') OR MID(va_g1_1,5,2) >='38') AND ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) BETWEEN  '153' AND '334') UNION ALL SELECT '(6-11) month death' AS FIELD, 'cumulative' AS cluster_type,COUNT(*) year_2020  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2020' AND ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) BETWEEN  '153' AND '334') UNION ALL SELECT '(6-11) month mortality rates' AS FIELD, 'high mortality' AS cluster_type, ROUND(((SELECT COUNT(*)  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2020' AND ((MID(va_g1_1,5,2) BETWEEN '01' AND '20') OR (MID(va_g1_1,5,2) BETWEEN '35' AND '37')) AND  ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) BETWEEN  '153' AND '334')) 	/  (SELECT COUNT(*)   FROM view_form1 WHERE form1_q24='1' AND DATE_FORMAT(STR_TO_DATE(form1_q18, '%d-%m-%Y'),'%Y')='2020' AND ((pw_block BETWEEN '01' AND '20') OR (pw_block BETWEEN '35' AND '37')))   ) * 1000,  0) AS year_2020 UNION ALL SELECT '(6-11) month mortality rates' AS FIELD, 'low mortality' AS cluster_type, ROUND(((SELECT COUNT(*)  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2020' AND ((MID(va_g1_1,5,2) BETWEEN '21' AND '34') OR MID(va_g1_1,5,2) >='38')  AND  ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) BETWEEN  '153' AND '334')) 	/  (SELECT COUNT(*)   FROM view_form1 WHERE form1_q24='1' AND DATE_FORMAT(STR_TO_DATE(form1_q18, '%d-%m-%Y'),'%Y')='2020' AND ((pw_block BETWEEN '21' AND '34') OR pw_block >='38'))   ) * 1000,  0) AS year_2020 UNION ALL SELECT '(6-11) month mortality rates' AS FIELD, 'cumulative' AS cluster_type, ROUND(((SELECT COUNT(*)  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2020' AND ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) BETWEEN  '153' AND '334')) 	/  (SELECT COUNT(*)   FROM view_form1 WHERE form1_q24='1' AND DATE_FORMAT(STR_TO_DATE(form1_q18, '%d-%m-%Y'),'%Y')='2020')   ) * 1000,  0) AS year_2020	 UNION ALL SELECT '(2-5) month death' AS FIELD, 'high mortality' AS cluster_type,COUNT(*) year_2020  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2020' AND ((MID(va_g1_1,5,2) BETWEEN '01' AND '20') OR (MID(va_g1_1,5,2) BETWEEN '35' AND '37')) AND  ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) BETWEEN '60' AND '152') UNION ALL SELECT '(2-5) month death' AS FIELD, 'low mortality' AS cluster_type,COUNT(*) year_2020  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2020' AND ((MID(va_g1_1,5,2) BETWEEN '21' AND '34') OR MID(va_g1_1,5,2) >='38') AND ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) BETWEEN   '60' AND '152') UNION ALL SELECT '(2-5) month death' AS FIELD, 'cumulative' AS cluster_type,COUNT(*) year_2020  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2020' AND ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) BETWEEN   '60' AND '152') UNION ALL SELECT '(2-5) month mortality rate' AS FIELD, 'high mortality' AS cluster_type, ROUND(((SELECT COUNT(*)  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2020' AND ((MID(va_g1_1,5,2) BETWEEN '01' AND '20') OR (MID(va_g1_1,5,2) BETWEEN '35' AND '37')) AND  ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) BETWEEN   '60' AND '152')) 	/  (SELECT COUNT(*)   FROM view_form1 WHERE form1_q24='1' AND DATE_FORMAT(STR_TO_DATE(form1_q18, '%d-%m-%Y'),'%Y')='2020' AND ((pw_block BETWEEN '01' AND '20') OR (pw_block BETWEEN '35' AND '37')))   ) * 1000,  0) AS year_2020 UNION ALL SELECT '(2-5) month mortality rate' AS FIELD, 'low mortality' AS cluster_type, ROUND(((SELECT COUNT(*)  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2020' AND ((MID(va_g1_1,5,2) BETWEEN '21' AND '34') OR MID(va_g1_1,5,2) >='38')  AND  ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) BETWEEN   '60' AND '152')) 	/  (SELECT COUNT(*)   FROM view_form1 WHERE form1_q24='1' AND DATE_FORMAT(STR_TO_DATE(form1_q18, '%d-%m-%Y'),'%Y')='2020' AND ((pw_block BETWEEN '21' AND '34') OR pw_block >='38'))   ) * 1000,  0) AS year_2020 UNION ALL SELECT '(2-5) month mortality rate' AS FIELD, 'cumulative' AS cluster_type, ROUND(((SELECT COUNT(*)  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2020' AND ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) BETWEEN   '60' AND '152')) 	/  (SELECT COUNT(*)   FROM view_form1 WHERE form1_q24='1' AND DATE_FORMAT(STR_TO_DATE(form1_q18, '%d-%m-%Y'),'%Y')='2020')   ) * 1000,  0) AS year_2020	 UNION ALL SELECT '(28-59) days death' AS FIELD, 'high mortality' AS cluster_type,COUNT(*) year_2020  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2020' AND ((MID(va_g1_1,5,2) BETWEEN '01' AND '20') OR (MID(va_g1_1,5,2) BETWEEN '35' AND '37')) AND  ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) BETWEEN '28' AND '59') UNION ALL SELECT '(28-59) days death' AS FIELD, 'low mortality' AS cluster_type,COUNT(*) year_2020  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2020' AND ((MID(va_g1_1,5,2) BETWEEN '21' AND '34') OR MID(va_g1_1,5,2) >='38') AND ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) BETWEEN   '28' AND '59') UNION ALL SELECT '(28-59) days death' AS FIELD, 'cumulative' AS cluster_type,COUNT(*) year_2020  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2020' AND ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) BETWEEN   '28' AND '59') UNION ALL SELECT '(28-59) days mortality rate' AS FIELD, 'high mortality' AS cluster_type, ROUND(((SELECT COUNT(*)  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2020' AND ((MID(va_g1_1,5,2) BETWEEN '01' AND '20') OR (MID(va_g1_1,5,2) BETWEEN '35' AND '37')) AND  ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) BETWEEN   '28' AND '59')) 	/  (SELECT COUNT(*)   FROM view_form1 WHERE form1_q24='1' AND DATE_FORMAT(STR_TO_DATE(form1_q18, '%d-%m-%Y'),'%Y')='2020' AND ((pw_block BETWEEN '01' AND '20') OR (pw_block BETWEEN '35' AND '37')))   ) * 1000,  0) AS year_2020 UNION ALL SELECT '(28-59) days mortality rate' AS FIELD, 'low mortality' AS cluster_type, ROUND(((SELECT COUNT(*)  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2020' AND ((MID(va_g1_1,5,2) BETWEEN '21' AND '34') OR MID(va_g1_1,5,2) >='38')  AND  ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) BETWEEN   '28' AND '59')) 	/  (SELECT COUNT(*)   FROM view_form1 WHERE form1_q24='1' AND DATE_FORMAT(STR_TO_DATE(form1_q18, '%d-%m-%Y'),'%Y')='2020' AND ((pw_block BETWEEN '21' AND '34') OR pw_block >='38'))   ) * 1000,  0) AS year_2020 UNION ALL SELECT '(28-59) days mortality rate' AS FIELD, 'cumulative' AS cluster_type, ROUND(((SELECT COUNT(*)  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2020' AND ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) BETWEEN   '28' AND '59')) 	/  (SELECT COUNT(*)   FROM view_form1 WHERE form1_q24='1' AND DATE_FORMAT(STR_TO_DATE(form1_q18, '%d-%m-%Y'),'%Y')='2020')   ) * 1000,  0) AS year_2020	 UNION ALL SELECT 'number of neonatal deaths' AS FIELD, 'high mortality' AS cluster_type,COUNT(*) year_2020  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2020' AND ((MID(va_g1_1,5,2) BETWEEN '01' AND '20') OR (MID(va_g1_1,5,2) BETWEEN '35' AND '37')) AND  ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y')))   <=27  AND (ABS(STR_TO_DATE(CONCAT(DATE_FORMAT(STR_TO_DATE(va_g1_5,'%d-%m-%Y'),'%d-%m-%Y'),' ', STR_TO_DATE(va_g1_5_time,  '%H:%i')),'%d-%m-%Y %H:%i')) - ABS(STR_TO_DATE(CONCAT(DATE_FORMAT(STR_TO_DATE(va_g1_4,'%d-%m-%Y'),'%d-%m-%Y'),' ', STR_TO_DATE(va_g1_4_time,  '%H:%i')),'%d-%m-%Y %H:%i'))) >0 ) UNION ALL SELECT 'number of neonatal deaths' AS FIELD, 'low mortality' AS cluster_type,COUNT(*) year_2020  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2020' AND ((MID(va_g1_1,5,2) BETWEEN '21' AND '34') OR MID(va_g1_1,5,2) >='38') AND ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y')))    <=27  AND (ABS(STR_TO_DATE(CONCAT(DATE_FORMAT(STR_TO_DATE(va_g1_5,'%d-%m-%Y'),'%d-%m-%Y'),' ', STR_TO_DATE(va_g1_5_time,  '%H:%i')),'%d-%m-%Y %H:%i')) - ABS(STR_TO_DATE(CONCAT(DATE_FORMAT(STR_TO_DATE(va_g1_4,'%d-%m-%Y'),'%d-%m-%Y'),' ', STR_TO_DATE(va_g1_4_time,  '%H:%i')),'%d-%m-%Y %H:%i'))) >0 ) UNION ALL SELECT 'number of neonatal deaths' AS FIELD, 'cumulative' AS cluster_type,COUNT(*) year_2020  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2020' AND ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y')))    <=27  AND (ABS(STR_TO_DATE(CONCAT(DATE_FORMAT(STR_TO_DATE(va_g1_5,'%d-%m-%Y'),'%d-%m-%Y'),' ', STR_TO_DATE(va_g1_5_time,  '%H:%i')),'%d-%m-%Y %H:%i')) - ABS(STR_TO_DATE(CONCAT(DATE_FORMAT(STR_TO_DATE(va_g1_4,'%d-%m-%Y'),'%d-%m-%Y'),' ', STR_TO_DATE(va_g1_4_time,  '%H:%i')),'%d-%m-%Y %H:%i'))) >0 )  UNION ALL SELECT 'Neonatal mortality rate' AS FIELD, 'high mortality' AS cluster_type, ROUND(((SELECT COUNT(*)  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2020' AND ((MID(va_g1_1,5,2) BETWEEN '01' AND '20') OR (MID(va_g1_1,5,2) BETWEEN '35' AND '37')) AND  ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y')))    <=27  AND (ABS(STR_TO_DATE(CONCAT(DATE_FORMAT(STR_TO_DATE(va_g1_5,'%d-%m-%Y'),'%d-%m-%Y'),' ', STR_TO_DATE(va_g1_5_time,  '%H:%i')),'%d-%m-%Y %H:%i')) - ABS(STR_TO_DATE(CONCAT(DATE_FORMAT(STR_TO_DATE(va_g1_4,'%d-%m-%Y'),'%d-%m-%Y'),' ', STR_TO_DATE(va_g1_4_time,  '%H:%i')),'%d-%m-%Y %H:%i'))) >0 )) 	/  (SELECT COUNT(*)   FROM view_form1 WHERE form1_q24='1' AND DATE_FORMAT(STR_TO_DATE(form1_q18, '%d-%m-%Y'),'%Y')='2020' AND ((pw_block BETWEEN '01' AND '20') OR (pw_block BETWEEN '35' AND '37')))   ) * 1000,  0) AS year_2020 UNION ALL SELECT 'Neonatal mortality rate' AS FIELD, 'low mortality' AS cluster_type, ROUND(((SELECT COUNT(*)  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2020' AND ((MID(va_g1_1,5,2) BETWEEN '21' AND '34') OR MID(va_g1_1,5,2) >='38')  AND  ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y')))     <=27  AND (ABS(STR_TO_DATE(CONCAT(DATE_FORMAT(STR_TO_DATE(va_g1_5,'%d-%m-%Y'),'%d-%m-%Y'),' ', STR_TO_DATE(va_g1_5_time,  '%H:%i')),'%d-%m-%Y %H:%i')) - ABS(STR_TO_DATE(CONCAT(DATE_FORMAT(STR_TO_DATE(va_g1_4,'%d-%m-%Y'),'%d-%m-%Y'),' ', STR_TO_DATE(va_g1_4_time,  '%H:%i')),'%d-%m-%Y %H:%i'))) >0 )) 	/  (SELECT COUNT(*)   FROM view_form1 WHERE form1_q24='1' AND DATE_FORMAT(STR_TO_DATE(form1_q18, '%d-%m-%Y'),'%Y')='2020' AND ((pw_block BETWEEN '21' AND '34') OR pw_block >='38'))   ) * 1000,  0) AS year_2020 UNION ALL SELECT 'Neonatal mortality rate' AS FIELD, 'cumulative' AS cluster_type, ROUND(((SELECT COUNT(*)  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2020' AND ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y')))     <=27  AND (ABS(STR_TO_DATE(CONCAT(DATE_FORMAT(STR_TO_DATE(va_g1_5,'%d-%m-%Y'),'%d-%m-%Y'),' ', STR_TO_DATE(va_g1_5_time,  '%H:%i')),'%d-%m-%Y %H:%i')) - ABS(STR_TO_DATE(CONCAT(DATE_FORMAT(STR_TO_DATE(va_g1_4,'%d-%m-%Y'),'%d-%m-%Y'),' ', STR_TO_DATE(va_g1_4_time,  '%H:%i')),'%d-%m-%Y %H:%i'))) >0 )) 	/  (SELECT COUNT(*)   FROM view_form1 WHERE form1_q24='1' AND DATE_FORMAT(STR_TO_DATE(form1_q18, '%d-%m-%Y'),'%Y')='2020')   ) * 1000,  0) AS year_2020	 UNION ALL SELECT 'number of day zero neonatal deaths' AS FIELD, 'high mortality' AS cluster_type,COUNT(*) year_2020  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2020' AND ((MID(va_g1_1,5,2) BETWEEN '01' AND '20') OR (MID(va_g1_1,5,2) BETWEEN '35' AND '37')) AND  ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) =0  AND (ABS(STR_TO_DATE(CONCAT(DATE_FORMAT(STR_TO_DATE(va_g1_5,'%d-%m-%Y'),'%d-%m-%Y'),' ', STR_TO_DATE(va_g1_5_time,  '%H:%i')),'%d-%m-%Y %H:%i')) - ABS(STR_TO_DATE(CONCAT(DATE_FORMAT(STR_TO_DATE(va_g1_4,'%d-%m-%Y'),'%d-%m-%Y'),' ', STR_TO_DATE(va_g1_4_time,  '%H:%i')),'%d-%m-%Y %H:%i'))) >0 ) UNION ALL SELECT 'number of day zero neonatal deaths' AS FIELD, 'low mortality' AS cluster_type,COUNT(*) year_2020  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2020' AND ((MID(va_g1_1,5,2) BETWEEN '21' AND '34') OR MID(va_g1_1,5,2) >='38') AND ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y')))    =0    AND (ABS(STR_TO_DATE(CONCAT(DATE_FORMAT(STR_TO_DATE(va_g1_5,'%d-%m-%Y'),'%d-%m-%Y'),' ', STR_TO_DATE(va_g1_5_time,  '%H:%i')),'%d-%m-%Y %H:%i')) - ABS(STR_TO_DATE(CONCAT(DATE_FORMAT(STR_TO_DATE(va_g1_4,'%d-%m-%Y'),'%d-%m-%Y'),' ', STR_TO_DATE(va_g1_4_time,  '%H:%i')),'%d-%m-%Y %H:%i'))) >0 ) UNION ALL SELECT 'number of day zero neonatal deaths' AS FIELD, 'cumulative' AS cluster_type,COUNT(*) year_2020  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2020' AND ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) =0    AND (ABS(STR_TO_DATE(CONCAT(DATE_FORMAT(STR_TO_DATE(va_g1_5,'%d-%m-%Y'),'%d-%m-%Y'),' ', STR_TO_DATE(va_g1_5_time,  '%H:%i')),'%d-%m-%Y %H:%i')) - ABS(STR_TO_DATE(CONCAT(DATE_FORMAT(STR_TO_DATE(va_g1_4,'%d-%m-%Y'),'%d-%m-%Y'),' ', STR_TO_DATE(va_g1_4_time,  '%H:%i')),'%d-%m-%Y %H:%i'))) >0 ) UNION ALL SELECT 'Day zero Neonatal mortality rate' AS FIELD, 'high mortality' AS cluster_type, ROUND(((SELECT COUNT(*)  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2020' AND ((MID(va_g1_1,5,2) BETWEEN '01' AND '20') OR (MID(va_g1_1,5,2) BETWEEN '35' AND '37')) AND  ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) =0    AND (ABS(STR_TO_DATE(CONCAT(DATE_FORMAT(STR_TO_DATE(va_g1_5,'%d-%m-%Y'),'%d-%m-%Y'),' ', STR_TO_DATE(va_g1_5_time,  '%H:%i')),'%d-%m-%Y %H:%i')) - ABS(STR_TO_DATE(CONCAT(DATE_FORMAT(STR_TO_DATE(va_g1_4,'%d-%m-%Y'),'%d-%m-%Y'),' ', STR_TO_DATE(va_g1_4_time,  '%H:%i')),'%d-%m-%Y %H:%i'))) >0 )) 	/  (SELECT COUNT(*)   FROM view_form1 WHERE form1_q24='1' AND DATE_FORMAT(STR_TO_DATE(form1_q18, '%d-%m-%Y'),'%Y')='2020' AND ((pw_block BETWEEN '01' AND '20') OR (pw_block BETWEEN '35' AND '37')))   ) * 1000,  0) AS year_2020 UNION ALL SELECT 'Day zero Neonatal mortality rate' AS FIELD, 'low mortality' AS cluster_type, ROUND(((SELECT COUNT(*)  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2020' AND ((MID(va_g1_1,5,2) BETWEEN '21' AND '34') OR MID(va_g1_1,5,2) >='38')  AND  ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) =0    AND (ABS(STR_TO_DATE(CONCAT(DATE_FORMAT(STR_TO_DATE(va_g1_5,'%d-%m-%Y'),'%d-%m-%Y'),' ', STR_TO_DATE(va_g1_5_time,  '%H:%i')),'%d-%m-%Y %H:%i')) - ABS(STR_TO_DATE(CONCAT(DATE_FORMAT(STR_TO_DATE(va_g1_4,'%d-%m-%Y'),'%d-%m-%Y'),' ', STR_TO_DATE(va_g1_4_time,  '%H:%i')),'%d-%m-%Y %H:%i'))) >0 )) 	/  (SELECT COUNT(*)   FROM view_form1 WHERE form1_q24='1' AND DATE_FORMAT(STR_TO_DATE(form1_q18, '%d-%m-%Y'),'%Y')='2020' AND ((pw_block BETWEEN '21' AND '34') OR pw_block >='38'))   ) * 1000,  0) AS year_2020 UNION ALL SELECT 'Day zero Neonatal mortality rate' AS FIELD, 'cumulative' AS cluster_type, ROUND(((SELECT COUNT(*)  FROM cod_vasa WHERE DATE_FORMAT(STR_TO_DATE(va_g1_5, '%d-%m-%Y'),'%Y')='2020' AND ((TO_DAYS(STR_TO_DATE(va_g1_5,'%d-%m-%Y')) - TO_DAYS(STR_TO_DATE(va_g1_4,'%d-%m-%Y'))) =0    AND (ABS(STR_TO_DATE(CONCAT(DATE_FORMAT(STR_TO_DATE(va_g1_5,'%d-%m-%Y'),'%d-%m-%Y'),' ', STR_TO_DATE(va_g1_5_time,  '%H:%i')),'%d-%m-%Y %H:%i')) - ABS(STR_TO_DATE(CONCAT(DATE_FORMAT(STR_TO_DATE(va_g1_4,'%d-%m-%Y'),'%d-%m-%Y'),' ', STR_TO_DATE(va_g1_4_time,  '%H:%i')),'%d-%m-%Y %H:%i'))) >0 )) 	/  (SELECT COUNT(*)   FROM view_form1 WHERE form1_q24='1' AND DATE_FORMAT(STR_TO_DATE(form1_q18, '%d-%m-%Y'),'%Y')='2020')   ) * 1000,  0) AS year_2020	 ) TableC ON TableA.field=TableC.field AND TableA.cluster_type=TableC.cluster_type", con);
                {
                    MySqlDataAdapter sda = new MySqlDataAdapter();
                    {
                        cmd.Connection = con;
                        sda.SelectCommand = cmd;
                        DataTable dt = new DataTable();
                        {
                            sda.Fill(dt);
                            GridView3.DataSource = dt;
                            GridView3.DataBind();
                            con.Close();
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                Response.Write("<script type=\"text/javascript\">alert('" + ex.Message + "')</script>");
            }
            finally
            {
                con.Close();
            }
        }











        private void ShowEnrollment()
        {
            MySqlConnection con = new MySqlConnection(constr);
            try
            {
                con.Open();
                MySqlCommand cmd = new MySqlCommand("(select sra_name as 'User Name',pw_block as Block, count(*) as 'Enrollment Done' from view_form1 where str_to_date(form1_q01, '%d-%m-%Y') BETWEEN str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y')  and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')  group by sra_name,pw_block order by pw_block,sra_name) union all (select 'All User','Cumulative', count(*) as 'Enrollment Done' from view_form1 where str_to_date(form1_q01, '%d-%m-%Y') BETWEEN str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y')  and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y') ) ", con);
                {
                    MySqlDataAdapter sda = new MySqlDataAdapter();
                    {
                        cmd.Connection = con;
                        sda.SelectCommand = cmd;
                        DataTable dt = new DataTable();
                        {
                            sda.Fill(dt);
                            GridView1.DataSource = dt;
                            GridView1.DataBind();
                            con.Close();
                            GridView1.Rows[GridView1.Rows.Count - 1].BackColor = System.Drawing.Color.FromName("#ebf598");
                            GridView1.Rows[GridView1.Rows.Count - 1].ForeColor = System.Drawing.Color.FromName("#006e25");
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                Response.Write("<script type=\"text/javascript\">alert('" + ex.Message + "')</script>");
            }
            finally
            {
                con.Close();
            }
        }




        protected void OnRowDataBound(object sender, GridViewRowEventArgs e)
        {
            if (e.Row.RowType == DataControlRowType.DataRow)
            {
                e.Row.Attributes.Add("onmouseover", "this.style.backgroundColor='#fdcb6e'");
                e.Row.Attributes.Add("onmouseout", "this.style.backgroundColor='White'");

                if (e.Row.Cells[2].Text == "cumulative")
                {
                    e.Row.Attributes.Add("onmouseout", "this.style.backgroundColor='#ebf598'");
                    e.Row.BackColor = Color.FromName("#ebf598");
                    e.Row.ForeColor = Color.FromName("#006e25");
                }
            }   
        }




        private void ShowFollowups()
        {
            MySqlConnection con = new MySqlConnection(constr);
            try
            {
                con.Open();
                MySqlCommand cmd = new MySqlCommand("(select sra_name as 'User Name',pw_block as Block, count(*) as 'Followups Done' from view_form2 where str_to_date(q01, '%d-%m-%Y') BETWEEN str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y')  and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y')  group by sra_name,pw_block order by pw_block,sra_name) union all (select 'All User','Cumulative', count(*) as 'Followups Done' from view_form2 where str_to_date(q01, '%d-%m-%Y') BETWEEN str_to_date('" + txtCalndrDate.Text + "', '%d-%m-%Y')  and str_to_date('" + txtCalndrDate1.Text + "', '%d-%m-%Y'))", con);
                {
                    MySqlDataAdapter sda = new MySqlDataAdapter();
                    {
                        cmd.Connection = con;
                        sda.SelectCommand = cmd;
                        DataTable dt = new DataTable();
                        {
                            sda.Fill(dt);
                            GridView2.DataSource = dt;
                            GridView2.DataBind();
                            con.Close();
                            GridView2.Rows[GridView2.Rows.Count - 1].BackColor = System.Drawing.Color.FromName("#ebf598");
                            GridView2.Rows[GridView2.Rows.Count - 1].ForeColor = System.Drawing.Color.FromName("#006e25");
                        }
                    }
                }
            }
            catch (Exception ex)
            {
                Response.Write("<script type=\"text/javascript\">alert('" + ex.Message + "')</script>");
            }
            finally
            {
                con.Close();
            }
        }






        private void LoadChartBirthCapturing()
        {
            try
            {
                string query = string.Format("select concat(Date_Format(str_to_date(form1_q01, '%d-%m-%Y'),'%b'),'-',Date_Format(str_to_date(form1_q01, '%d-%m-%Y'),'%y')) as Year, count(*) as birth_capture	   from view_form1  group by Year(str_to_date(form1_q01, '%d-%m-%Y')),Month(str_to_date(form1_q01, '%d-%m-%Y'))");
                DataTable dt = GetData(query);
                Chart2.DataSource = dt;
                Chart2.Series[0].XValueMember = "Year";
                Chart2.Series[0].YValueMembers = "birth_capture";
                Chart2.Series[0].Label = "#VALY";
                Chart2.ChartAreas["ChartArea2"].AxisX.MajorGrid.Enabled = false;
                Chart2.DataBind();


                ////  Target Line:
                //StripLine targetLine = new StripLine();
                //targetLine.StripWidth = 0;
                //targetLine.BorderColor = ColorTranslator.FromHtml("#55efc4");
                //targetLine.BorderWidth = 3;
                //targetLine.BorderDashStyle = ChartDashStyle.Dash;
                //targetLine.IntervalOffset = 120; // In my case I am plotting percentages.
                //targetLine.Text = "Target";
                //targetLine.TextOrientation = TextOrientation.Horizontal;
                //targetLine.ForeColor = targetLine.BorderColor;
                //Chart2.ChartAreas[0].AxisY.StripLines.Add(targetLine);
            }
            catch (Exception ex)
            {
                Response.Write("<script type=\"text/javascript\">alert('" + ex.Message + "')</script>");
            }

        }



        private void LoadChartLiveBirth()
        {
            try
            {
                string query = string.Format("select concat(Date_Format(str_to_date(form1_q18, '%d-%m-%Y'),'%b'),'-',Date_Format(str_to_date(form1_q18, '%d-%m-%Y'),'%y')) as Year, count(*) as birth_capture	   from view_form1  where   form1_q24='1'    group by Year(str_to_date(form1_q18, '%d-%m-%Y')),Month(str_to_date(form1_q18, '%d-%m-%Y'))");
                DataTable dt = GetData(query);
                Chart3.DataSource = dt;
                Chart3.Series[0].XValueMember = "Year";
                Chart3.Series[0].YValueMembers = "birth_capture";
                Chart3.Series[0].Label = "#VALY";
                Chart3.ChartAreas["ChartArea3"].AxisX.MajorGrid.Enabled = false;
                Chart3.DataBind();


                ////   Target Line:
                //StripLine targetLine = new StripLine();
                //targetLine.StripWidth = 0;
                //targetLine.BorderColor = ColorTranslator.FromHtml("#55efc4");
                //targetLine.BorderWidth = 3;
                //targetLine.BorderDashStyle = ChartDashStyle.Dash;
                //targetLine.IntervalOffset = 120; // In my case I am plotting percentages.
                //targetLine.Text = "Target";
                //targetLine.TextOrientation = TextOrientation.Horizontal;
                //targetLine.ForeColor = targetLine.BorderColor;
                //Chart3.ChartAreas[0].AxisY.StripLines.Add(targetLine);
            }
            catch (Exception ex)
            {
                Response.Write("<script type=\"text/javascript\">alert('" + ex.Message + "')</script>");
            }

        }




        //For Cumulative:
        private static DataTable GetData(string query)
        {
            string constr = ConfigurationManager.ConnectionStrings["LocalMySql"].ConnectionString;

            MySqlConnection con = new MySqlConnection(constr);
            {
                using (MySqlCommand cmd = new MySqlCommand(query))
                {
                    DataTable dt = new DataTable();
                    using (MySqlDataAdapter sda = new MySqlDataAdapter(query, con))
                    {
                        sda.Fill(dt);
                    }
                    return dt;
                }
            }
        }


    }
}